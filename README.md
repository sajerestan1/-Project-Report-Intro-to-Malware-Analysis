# Project-Report-Intro-to-Malware-Analysis

### Intro to Malware Analysis Write-Up

![image](https://github.com/user-attachments/assets/99ef57c9-a562-46e1-a6d6-e0442b7a5781)


Scenario

This project focuses on basic malware analysis techniques. The room, "Intro to Malware Analysis," provided on TryHackMe, aims to teach the fundamental concepts of static and dynamic analysis and how to investigate malware samples. This report will guide you through my experience while working on the challenges, highlighting the methods I used to answer the questions, and concluding with my thoughts and what I gained from this project.

#### Task 2: Malware Analysis

##### 1. Which team uses malware analysis to look for IOCs and hunt for malware in a network?

The answer is found directly in the reading material, which introduces the teams responsible for analyzing malware and identifying indicators of compromise (IOCs).

Answer: Threat hunt team

#### Task 3: Techniques of Malware Analysis

##### 1. Which technique is used for analyzing malware without executing it?

Static analysis is a technique where malware is analyzed without executing it. This method involves looking at the file structure and code to understand the malware’s functionality.

Answer: Static analysis

#### 2. Which technique is used for analyzing malware by executing it and observing its behavior in a controlled environment?

Dynamic analysis, on the other hand, involves running the malware in a sandbox or virtual machine to observe its behavior, such as file system changes or network connections, to understand what it does.

Answer: Dynamic analysis

#### Task 4: Basic Static Analysis

1. In the attached VM, there is a sample named ‘redline’ in the Desktop/Samples directory. What is the md5sum of this sample?

To get the MD5 hash of the sample, I navigated to the correct directory using the command line:

![image](https://github.com/user-attachments/assets/86afdf8f-355a-477d-9baa-1960bce60d06)

bash

cd ~/Desktop/Samples/

Once there, I ran the md5sum command to retrieve the hash of the "redline" sample:

bash

md5sum redline

The result provided the MD5 hash, which I copied.

Answer: ca2dc5a3f94c4f19334cc8b68f256259

#### 2. What is the creation time of this sample?

I pasted the MD5 hash into VirusTotal and found the creation time in the "Details" section of the report.

Answer: 2020–08–01 02:44:18 UTC

Task 5: The PE File Header

1. In the attached VM, there is a sample named ‘redline’ in the directory Desktop/Samples. What is the entropy of the .text section of this sample?

I used the pecheck command to analyze the Portable Executable (PE) file and find the entropy value for the .text section.

bash

pecheck redline

The output provided the entropy value.

Answer: 6.453919

2. The sample named ‘redline’ has five sections. .text, .rdata, .data, and .rsrc are four of them. What is the name of the fifth section?

From the same pecheck output, I checked for the fifth section name and found that it was ".ndata."

Answer: .ndata

#### 3. From which dll file does the sample named ‘redline’ import the RegOpenKeyExW function?

I used grep to filter the results for the specific function RegOpenKeyExW:

bash

pecheck redline | grep -i “regopenkey”

This search revealed that the function is imported from ADVAPI32.dll.

Answer: ADVAPI32.dll

Task 6: Basic Dynamic Analysis

#### 1. Check the hash of the sample 'redline' on Hybrid analysis and check out the hybrid analysis report. In the process tree, which is the first process launched when the sample is launched?

![image](https://github.com/user-attachments/assets/754d27ed-87dd-4a48-99d8-0be101f3a67b)

I went to Hybrid Analysis, entered the MD5 hash of the "redline" sample, and found the report generated on 9 Dec 2022. The Incident Response section revealed the number of domains contacted by the malware.

![image](https://github.com/user-attachments/assets/3d2e9417-cf3c-4a61-9cb6-82430666e883)

Answer: setup_installer.exe

#### 2. In the process tree, there are two Windows utilities utilized by the malware to perform its activities. What are the names of the two utilities? (Format: utility1.exe and utility2.exe)

Using the report, I searched for .txt files and found that the name of the accessed text file was fj4ghga23_fsa.txt.

Answer: cmd.exe and powershell.exe

### Task 7: Anti-Analysis Techniques

#### 1. Which of the techniques discussed above is used to bypass static analysis?

Packing is a common technique used to bypass static analysis by compressing or encrypting the malware’s code.

Answer: Packing

#### 2. Which technique discussed above is used to time out a sandbox?

Long sleep calls are used by malware to delay its execution, causing a sandbox to time out before the malware shows its true behavior.

Answer: Long sleep calls

### Conclusion

This project gave me an in-depth introduction to malware analysis techniques, both static and dynamic. I learned how to gather meaningful data from malware samples, such as MD5 hashes, file sections, and function imports. The use of tools like VirusTotal and Hybrid Analysis expanded my understanding of malware behavior and how to use online resources for further analysis.
Experience Gained

Static Analysis: I learned how to extract information from a malware sample without running it, using commands like md5sum and pecheck to inspect the file structure and sections.
    
Dynamic Analysis: Executing malware in a controlled environment provided insight into its real-time behavior, such as contacting domains or accessing files.
    
Utilizing Online Resources: Tools like VirusTotal and Hybrid Analysis allowed me to cross-reference the sample’s hash with known malware reports, speeding up the identification process.

Benefits


Deeper Understanding: This project gave me a solid foundation in both static and dynamic analysis techniques.
    
Better Tool Utilization: I now have more confidence in using tools like pecheck, md5sum, VirusTotal, and Hybrid Analysis.
    
Real-World Relevance: Understanding these techniques will be crucial when dealing with malware in SOC environments, where quick identification and analysis of malware are essential to mitigate threats effectively.

This project significantly boosted my confidence in malware analysis and prepared me for more advanced malware hunting in future challenges.
